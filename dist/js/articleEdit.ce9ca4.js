(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{627:function(e,t,a){},628:function(e,t,a){},757:function(e,t,a){"use strict";var i=a(627);a.n(i).a},758:function(e,t,a){"use strict";var i=a(628);a.n(i).a},844:function(e,t,a){"use strict";a.r(t);var i=a(121),l=a.n(i),r=a(180),n=a.n(r),s=a(181),o=a(71),c=a(690),u={props:{value:{type:String,default:""}},data:function(){return{editorId:"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0),editorLoading:!1,hasInput:!1}},watch:{value:function(e){this.hasInput||tinymce.get(this.editorId).setContent(e),""==e&&tinymce.get(this.editorId).setContent(e)}},mounted:function(){this.editorLoading=!0,this.initTinymce()},destroyed:function(){this.destoryTinymce()},activated:function(){this.editorLoading=!0,this.initTinymce()},deactivated:function(){this.destoryTinymce()},methods:{initTinymce:function(){var e=this;tinymce.init({selector:"#"+this.editorId,language:"zh_CN",height:400,plugins:"advlist autosave autolink charmap code colorpicker contextmenu emoticons fullscreen help hr image  insertdatetime link lists media pagebreak paste preview print searchreplace table textcolor textpattern visualblocks visualchars wordcount",toolbar:"restoredraft | undo redo | styleselect | bold italic underline forecolor backcolor removeformat | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | table link image media emoticons | searchreplace fullscreen preview code print",contextmenu:"copy paste | link image inserttable",default_link_target:"_blank",link_context_toolbar:!0,link_assume_external_targets:!0,setup:function(e){},init_instance_callback:function(t){t.setContent(e.value),e.editorLoading=!1,t.on("setContent keyup nodeChange",function(){""!=e.value&&(e.hasInput=!0),e.$emit("input",t.getContent())})},images_upload_handler:function(e,t,a){var i=e.blob();(new FormData).append("image",i);var l=e.base64(),r=i.type;"image/jpeg"==r?l="data:image/jpeg;base64,"+l:"image/png"==r?l="data:image/png;base64,"+l:"image/gif"==r&&(l="data:image/gif;base64,"+l),t(l)}})},destoryTinymce:function(){tinymce.get(this.editorId)&&tinymce.get(this.editorId).destroy()}}},d=a(70),p=Object(d.a)(u,function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-input",{directives:[{name:"loading",rawName:"v-loading",value:this.editorLoading,expression:"editorLoading"}],attrs:{type:"textarea",id:this.editorId}})],1)},[],!1,null,null,null).exports,m={props:["articleId"],components:{SectionTitle:c.a,Tinymce:p},data:function(){return{articleDetail:{title:"",author:"",date:"",imageUrl:"",type:"",brief:"",content:""},formRules:{title:[{required:!0,message:"请填写文章标题",trigger:"blur"},{max:20,message:"标题不能超过20个字",trigger:"blur"}],type:[{required:!0,message:"请选择文章类型",trigger:"change"}]},articleTypes:s.a.getTable("article"),publishLoading:!1}},watch:{$route:function(){this.getDetail()}},created:function(){this.getDetail()},methods:{getDetail:function(){var e=this;return n()(l.a.mark(function t(){var a,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.articleId){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,o.a.article.getDetail({id:e.articleId});case 4:a=t.sent,i=a.data.articleDetail,e.articleDetail={title:i.title,author:i.author,date:e.$dayjs(i.date).format("YYYY-MM-DD HH:mm:ss"),imageUrl:i.imageUrl,type:i.type,brief:i.brief,content:i.content};case 7:case"end":return t.stop()}},t,e)}))()},beforeImageUpload:function(e){var t=/\.(jpg|png)$/.test(e.name),a=e.size/1024/1024<2;return t||this.$message.error("上传的图片只能是jpg或png格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},handleImageSuccess:function(e,t){this.articleDetail.image=URL.createObjectURL(t.raw)},handleAccessorySuccess:function(){this.$message.success("上传成功")},handlePublish:function(){this.$message.success("发布成功")}}},g=(a(757),a(758),Object(d.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article-edit"},[a("div",{staticClass:"article-edit__header"},[a("section-title",{attrs:{name:e.articleId?"编辑文章":"新增文章"}}),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",icon:"el-icon-s-promotion",loading:e.publishLoading},on:{click:e.handlePublish}},[e._v("发布")])],1),e._v(" "),a("div",{staticClass:"article-list__form"},[a("el-form",{attrs:{model:e.articleDetail,rules:e.formRules,"label-width":"100px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章标题:",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入文章标题",clearable:""},model:{value:e.articleDetail.title,callback:function(t){e.$set(e.articleDetail,"title",t)},expression:"articleDetail.title"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章类型:",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择文章类型",clearable:""},model:{value:e.articleDetail.type,callback:function(t){e.$set(e.articleDetail,"type",t)},expression:"articleDetail.type"}},e._l(e.articleTypes,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章简介:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:100,placeholder:"请输入文章简介",clearable:""},model:{value:e.articleDetail.brief,callback:function(t){e.$set(e.articleDetail,"brief",t)},expression:"articleDetail.brief"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"标题图片:"}},[a("el-upload",{staticClass:"image-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"before-upload":e.beforeImageUpload,"on-success":e.handleImageSuccess}},[e.articleDetail.imageUrl?a("img",{staticClass:"image",attrs:{src:e.articleDetail.imageUrl}}):a("i",{staticClass:"el-icon-plus image-uploader-icon"})])],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"附件上传:"}},[a("el-input",{attrs:{placeholder:"请上传文件"}},[a("template",{slot:"append"},[a("el-upload",{attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"on-success":e.handleAccessorySuccess}},[a("el-button",{attrs:{type:"primary",round:""}},[e._v("点击上传")])],1)],1)],2)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"创建时间:",prop:"date"}},[a("el-input",{attrs:{disabled:""},model:{value:e.articleDetail.date,callback:function(t){e.$set(e.articleDetail,"date",t)},expression:"articleDetail.date"}})],1)],1)],1)],1)],1),e._v(" "),a("tinymce",{model:{value:e.articleDetail.content,callback:function(t){e.$set(e.articleDetail,"content",t)},expression:"articleDetail.content"}})],1)},[],!1,null,"0fde053f",null).exports);a.d(t,"default",function(){return g})}}]);