(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{608:function(e,t,a){},609:function(e,t,a){},697:function(e,t,a){"use strict";var i=a(608);a.n(i).a},698:function(e,t,a){"use strict";var i=a(609);a.n(i).a},792:function(e,t,a){"use strict";a.r(t);var i=a(586),l=a(92),r=a(662),n={props:{value:{type:String,default:""}},data:function(){return{editorId:"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0),editorLoading:!1,hasInput:!1}},watch:{value:function(e){this.hasInput||tinymce.get(this.editorId).setContent(e),""==e&&tinymce.get(this.editorId).setContent(e)}},mounted:function(){this.editorLoading=!0,this.initTinymce()},destroyed:function(){this.destoryTinymce()},activated:function(){this.editorLoading=!0,this.initTinymce()},deactivated:function(){this.destoryTinymce()},methods:{initTinymce:function(){var e=this;tinymce.init({selector:"#"+this.editorId,language:"zh_CN",height:400,plugins:"advlist autosave autolink charmap code colorpicker contextmenu emoticons fullscreen help hr image  insertdatetime link lists media pagebreak paste preview print searchreplace table textcolor textpattern visualblocks visualchars wordcount",toolbar:"restoredraft | undo redo | styleselect | bold italic underline forecolor backcolor removeformat | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | table link image media emoticons | searchreplace fullscreen preview code print",contextmenu:"copy paste | link image inserttable",default_link_target:"_blank",link_context_toolbar:!0,link_assume_external_targets:!0,setup:function(e){},init_instance_callback:function(t){t.setContent(e.value),e.editorLoading=!1,t.on("setContent keyup nodeChange",function(){""!=e.value&&(e.hasInput=!0),e.$emit("input",t.getContent())})},images_upload_handler:function(e,t,a){var i=e.blob();(new FormData).append("image",i);var l=e.base64(),r=i.type;"image/jpeg"==r?l="data:image/jpeg;base64,"+l:"image/png"==r?l="data:image/png;base64,"+l:"image/gif"==r&&(l="data:image/gif;base64,"+l),t(l)}})},destoryTinymce:function(){tinymce.get(this.editorId)&&tinymce.get(this.editorId).destroy()}}},s=a(67),o=Object(s.a)(n,function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-input",{directives:[{name:"loading",rawName:"v-loading",value:this.editorLoading,expression:"editorLoading"}],attrs:{type:"textarea",id:this.editorId}})],1)},[],!1,null,null,null).exports,c={props:["articleId"],components:{SectionTitle:r.a,Tinymce:o},data:function(){return{articleDetail:{title:"",author:"",date:"",imageUrl:"",type:"",brief:"",content:""},formRules:{title:[{required:!0,message:"请填写文章标题",trigger:"blur"},{max:20,message:"标题不能超过20个字",trigger:"blur"}],type:[{required:!0,message:"请选择文章类型",trigger:"change"}]},articleTypes:i.a.getTable("articleType"),publishLoading:!1}},watch:{$route:function(){this.getArticleDetail()}},created:function(){this.getArticleDetail()},methods:{getArticleDetail:function(){var e=this;this.articleId&&l.a.article.getDetail({id:this.articleId}).then(function(t){var a=t.data.articleDetail;e.articleDetail={title:a.title,author:a.author,date:e.$dayjs(a.date).format("YYYY-MM-DD HH:mm:ss"),imageUrl:a.imageUrl,type:a.type,brief:a.brief,content:a.content}})},beforeImageUpload:function(e){var t=/\.(jpg|png)$/.test(e.name),a=e.size/1024/1024<2;return t||this.$message.error("上传的图片只能是jpg或png格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},handleImageSuccess:function(e,t){this.articleDetail.image=URL.createObjectURL(t.raw)},handleAccessorySuccess:function(){},handlePublish:function(){this.$message.success("发布成功")}}},d=(a(697),a(698),Object(s.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article-edit"},[a("div",{staticClass:"article-edit__header"},[a("section-title",{attrs:{name:e.articleId?"编辑文章":"新增文章"}}),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",icon:"el-icon-s-promotion",loading:e.publishLoading},on:{click:e.handlePublish}},[e._v("发布")])],1),e._v(" "),a("div",{staticClass:"article-list__form"},[a("el-form",{attrs:{model:e.articleDetail,rules:e.formRules,"label-width":"100px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章标题:",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入文章标题",clearable:""},model:{value:e.articleDetail.title,callback:function(t){e.$set(e.articleDetail,"title",t)},expression:"articleDetail.title"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章类型:",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择文章类型",clearable:""},model:{value:e.articleDetail.type,callback:function(t){e.$set(e.articleDetail,"type",t)},expression:"articleDetail.type"}},e._l(e.articleTypes,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章简介:"}},[a("el-input",{attrs:{type:"textarea",rows:3,maxlength:100,placeholder:"请输入文章简介",clearable:""},model:{value:e.articleDetail.brief,callback:function(t){e.$set(e.articleDetail,"brief",t)},expression:"articleDetail.brief"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"标题图片:"}},[a("el-upload",{staticClass:"image-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"before-upload":e.beforeImageUpload,"on-success":e.handleImageSuccess}},[e.articleDetail.imageUrl?a("img",{staticClass:"image",attrs:{src:e.articleDetail.imageUrl}}):a("i",{staticClass:"el-icon-plus image-uploader-icon"})])],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"附件上传:"}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("template",{slot:"append"},[a("el-upload",{attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"on-success":e.handleAccessorySuccess}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")])],1)],1)],2)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"创建时间:",prop:"date"}},[a("el-input",{attrs:{disabled:""},model:{value:e.articleDetail.date,callback:function(t){e.$set(e.articleDetail,"date",t)},expression:"articleDetail.date"}})],1)],1)],1)],1)],1),e._v(" "),a("tinymce",{model:{value:e.articleDetail.content,callback:function(t){e.$set(e.articleDetail,"content",t)},expression:"articleDetail.content"}})],1)},[],!1,null,"48ce28b2",null).exports);a.d(t,"default",function(){return d})}}]);